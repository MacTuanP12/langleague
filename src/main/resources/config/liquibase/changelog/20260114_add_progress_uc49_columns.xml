<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">

    <!--
        Add UC-49 columns to Progress entity for enhanced progress tracking
        - Manual bookmark functionality
        - Auto-resume tracking
        - Granular section completion tracking
    -->
    <changeSet id="20260114-add-progress-uc49-columns" author="langleague">
        <comment>Add UC-49 columns to Progress table for bookmark, resume, and section tracking</comment>

        <addColumn tableName="progress">
            <!-- Manual bookmark flag for important units -->
            <column name="is_bookmarked" type="boolean" defaultValueBoolean="false">
                <constraints nullable="true"/>
            </column>

            <!-- Quiz/Exercise score (0-100) -->
            <column name="score" type="integer">
                <constraints nullable="true"/>
            </column>

            <!-- Last time user accessed this unit (for resume functionality) -->
            <column name="last_accessed_at" type="${datetimeType}">
                <constraints nullable="true"/>
            </column>

            <!-- Overall completion percentage within unit (0-100) -->
            <column name="completion_percentage" type="integer" defaultValueNumeric="0">
                <constraints nullable="true"/>
            </column>

            <!-- Vocabulary section completion flag -->
            <column name="is_vocabulary_finished" type="boolean" defaultValueBoolean="false">
                <constraints nullable="true"/>
            </column>

            <!-- Grammar section completion flag -->
            <column name="is_grammar_finished" type="boolean" defaultValueBoolean="false">
                <constraints nullable="true"/>
            </column>

            <!-- Exercise section completion flag -->
            <column name="is_exercise_finished" type="boolean" defaultValueBoolean="false">
                <constraints nullable="true"/>
            </column>
        </addColumn>
    </changeSet>

</databaseChangeLog>

